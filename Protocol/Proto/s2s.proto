syntax = "proto3";
package s2s;
import "google/protobuf/any.proto";

message Listener
{
    string name = 1;
    uint32 port = 2;
}

message NodeInfo
{
    int32 area_id = 1;   //区服id
    int32 node_id = 2;   //节点id
    string server_ip = 3;
    string server_name = 4;  //服务器名字
    repeated string services = 5;   //服务名列表
    map<string, int32> listeners = 6; //所有监听器
}

message GroupConfigData
{
    uint32 group_id = 1;     //组id
    int64 open_time = 2;     // 开启时间
    string token = 3;       //验证token
    string group_name = 4;
}

message NodeRegister
{
    message Request
    {
        NodeInfo node_info = 1;
    }
    message Response
    {
        int32 node_id = 1;
        GroupConfigData group_data = 2;
    }
}



message NodeQuery
{
    message Request
    {
        int32 AreaId = 1;
        string Service = 2;
    }
    message Response
    {
        repeated NodeInfo NodeInfos = 1;
    }
}

message HostQuery
{
    message Response
    {
        repeated string Hosts = 1;
    }
}

message MysqlResponse
{
    string ErrorString = 1;
    repeated google.protobuf.Any Datas = 2;
}

message MysqlQuery
{
    message Request
    {
        google.protobuf.Any Data = 1;
    }
}
message MysqlAnyOper
{
    message Request
    {
        string sql = 1;
        string tab = 2;
    }
}

message MysqlOper
{
    message Request
    {
        google.protobuf.Any Data = 1;
    }
}
