syntax = "proto3";
package s2s;
message cluster
{
    message join
    {
        string name = 1;
        string rpc = 2;
        string http = 3;
    }
    message exit
    {
        string name = 1;
        string rpc = 2;
        string http = 3;
    }
}

message user
{
    message login
    {
        int64 user_id = 1;
    }
    message logout
    {
        int64 user_id = 1;
    }
}

message allot
{
    message response
    {
        string token = 1;
        string address = 2; //网关地址
    }

    message save
    {
        string service = 1;
        string address = 2;
    }
}
message location
{
    message add
    {
        int64 user_id = 1;
        map<string, string> services = 2;
    }
    message del
    {
        int64 user_id = 1;
        repeated string services = 2;
    }
}

message forward
{
    message sub
    {
        repeated string channels = 1;
    }
    message unsub
    {
        repeated string channels = 1;
    }
    message publish
    {
        string channel = 1;
        string message = 2;
    }
}
