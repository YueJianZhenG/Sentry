syntax = "proto3";
import "google/protobuf/any.proto";
package db;
message mongo
{
    message insert
    {
        string tab = 1;
        string json = 2;
        int32 flag = 3;
    }

    message query
    {
        message request
        {
            string tab = 1;
            string json = 2;
            int32 limit = 3;
            repeated string fields = 4;
        }
        message response
        {
            repeated string jsons = 1;
        }
    }
    message remove
    {
        string tab = 1;
        string json = 2;
        int32 limit = 3;
        int32 flag = 4;
    }
    message index
    {
        string tab = 1;
        string name = 2;
    }
    message update
    {
        string tab = 1;
        string select = 2;
        string update = 3;
        string tag = 4;
        int32 flag = 5;
    }
    message command
    {
        message request
        {
            string json = 1;
        }
        message response
        {
            repeated bytes jsons = 1;
        }
    }
}

message mysql //mysql操作
{
    message create
    {
        string table = 1; // xxx.xxx
        repeated string keys = 2; //主键
        google.protobuf.Any data = 3; //pb结构可以有默认值
    }

    message exec
    {
        string sql = 1; //sql语句
        bool query = 2; //是否是查询语句
    }

    message add
    {
        int32 flag = 1;
        string table = 2;
        google.protobuf.Any data = 3;
    }
    message save
    {
        int32 flag = 1;
        string table = 2;
        google.protobuf.Any data = 3;
    }
    message query
    {
        string table = 1;
        int32 limit = 2;
        string where_json = 3;
        repeated string fields = 4;
    }
    message remove
    {
        int32 flag = 1;
        string table = 2;
        string where_json = 3;
    }
    message update
    {
        int32 flag = 1;
        string table = 2;
        string update_json = 3;
        string where_json = 4;
    }
    message response
    {
        string error = 1;
        repeated bytes jsons = 2;
    }
}

